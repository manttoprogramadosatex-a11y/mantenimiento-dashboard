<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tablero Master Mantto. Satex Textil</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
    margin:0;
    font-family: Arial, sans-serif;
    background: linear-gradient(to bottom, #1f3f5b, #274e73);
}

/* HEADER M√ÅS DELGADO */
.header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:8px 40px;   /* antes era 15px */
    background:#1f3f5b;
}

.logo{
    height:45px;
}

.titulo-header{
    flex:1;
    text-align:center;
    font-size:24px;
    font-weight:bold;
    color:white;
}

.fecha{
    color:white;
    font-size:14px;
}

/* CONTENEDOR */
.gauges-container{
    display:flex;
    justify-content:center;
    flex-wrap:wrap;
    gap:80px;
    margin-top:60px;
}

/* SOLO EL RELOJ ES BLANCO */
canvas{
    background:white;
    border-radius:50%;
    padding:15px;
    width:280px !important;
    height:280px !important;
}
</style>
</head>

<body>

<div class="header">
    <img src="logo.png.jpeg" class="logo">
    <div class="titulo-header">Tablero Master Mantto. Satex Textil</div>
    <div class="fecha" id="fecha"></div>
</div>

<div class="gauges-container">
    <canvas id="g1"></canvas>
    <canvas id="g2"></canvas>
    <canvas id="g3"></canvas>
</div>

<script>

/* FECHA */
const opciones = { weekday:'long', year:'numeric', month:'long', day:'numeric' };
let fecha = new Date().toLocaleDateString('es-ES', opciones);
fecha = fecha.charAt(0).toUpperCase() + fecha.slice(1);
document.getElementById("fecha").innerText = fecha;


/* PLUGIN AGUJA */
const gaugePlugin = {
    id:'gaugeNeedle',
    afterDraw(chart, args, options){

        const {ctx} = chart;
        const meta = chart.getDatasetMeta(0);
        const centerX = meta.data[0].x;
        const centerY = meta.data[0].y;
        const radius = meta.data[0].outerRadius;

        const value = options.value;
        const max = options.max;
        const angle = Math.PI + (value/max)*Math.PI;

        ctx.save();
        ctx.translate(centerX, centerY);
        ctx.rotate(angle);

        ctx.beginPath();
        ctx.moveTo(-3,0);
        ctx.lineTo(0,-radius+35);
        ctx.lineTo(3,0);
        ctx.fillStyle="red";
        ctx.fill();

        ctx.restore();

        /* CENTRO AZUL */
        ctx.beginPath();
        ctx.arc(centerX, centerY, 12, 0, 2*Math.PI);
        ctx.fillStyle="#2c6cb0";
        ctx.fill();

        /* TEXTO */
        ctx.font="18px Arial";
        ctx.fillStyle="black";
        ctx.textAlign="center";
        ctx.fillText("Toneladas", centerX, centerY-20);

        ctx.font="22px Arial";
        ctx.fillText(value.toLocaleString(), centerX, centerY+35);
    }
};

function createGauge(id,value,max){

    new Chart(document.getElementById(id),{
        type:'doughnut',
        data:{
            datasets:[{
                data:[max*0.2,max*0.3,max*0.5],
                backgroundColor:[
                    "#e74c3c",
                    "#f1c40f",
                    "#2ecc71"
                ],
                borderWidth:0
            }]
        },
        options:{
            rotation:180,
            circumference:180,
            cutout:"75%",
            plugins:{
                legend:{display:false},
                tooltip:{enabled:false},
                gaugeNeedle:{value:value,max:max}
            }
        },
        plugins:[gaugePlugin]
    });
}

/* VALORES EJEMPLO */
createGauge("g1",18,25);
createGauge("g2",12,25);
createGauge("g3",22,25);

</script>

</body>
</html>
