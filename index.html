<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Tablero Master Satex 2026</title>
    <script>const v = new Date().getTime(); document.write(`<link rel="stylesheet" href="estilos.css?v=${v}">`);</script>
    <style>
        body { background-color: #1a3a5a; margin: 0; overflow: hidden; font-family: sans-serif; }
        #cardas-grid { display: flex; flex-wrap: nowrap; overflow-x: auto; background: #24486d; padding: 10px; gap: 10px; height: 160px; }
        .mantenimiento-area { display: flex; height: calc(100vh - 280px); }
    </style>
</head>
<body>

    <div id="header-container"></div>
    <div id="estatus-container"></div>
    
    <div id="cardas-grid"></div>

    <div id="mantenimiento-container"></div>

    <script>
        const libs = [
            "lib_header_design.js", "lib_estatus_design.js", "lib_estatus_data.js",
            "lib_cardas_design.js", "lib_cardas_engine.js", "lib_mantenimiento.js",
            "lib_data_loader.js", "lib_pmc_donas_design.js", "lib_correctivo_kpi_design.js",
            "lib_preventivo_design.js", "lib_personal_mantto_design.js", "lib_compras_pendientes_design.js"
        ];
        libs.forEach(lib => document.write(`<script src="${lib}?v=${v}"><\/script>`));
    </script>

    <script>
        async function actualizarTodo() {
            console.log("Sincronizando datos...");
            // Actualiza Estatus Planta (Hilos, Máquinas paradas)
            await SatexEstatusData.actualizarDesdeSheet();
            // Actualiza Cardas (Datos de Toneladas Act vs Max)
            await SatexCardasEngine.dibujar("cardas-grid");
        }

        window.onload = async () => {
            // Renderizado inicial de estructuras
            SatexHeaderDesign.render("header-container");
            SatexEstatusDesign.render("estatus-container");
            SatexMantenimiento.render("mantenimiento-container");
            
            // Carga inicial de datos
            await actualizarTodo();

            // Refresco automático cada 15 segundos
            setInterval(actualizarTodo, 15000);
        };
    </script>
</body>
</html>
