<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { margin: 0; background: #2f5577; font-family: sans-serif; overflow: hidden; color: white; }
        .top-bar { display: flex; align-items: center; background: #274a66; padding: 5px 15px; gap: 10px; height: 55px; border-bottom: 2px solid #1e3a50; }
        .logo { height: 35px; }
        .title { flex-grow: 1; text-align: center; font-size: 18px; font-weight: bold; }
        
        .stats { display: flex; gap: 5px; align-items: center; background: rgba(0,0,0,0.2); padding: 5px; border-radius: 5px; }
        .box { background: #3c546d; border-left: 3px solid #f9b218; padding: 2px 8px; min-width: 85px; height: 35px; border-radius: 3px; }
        .box-r { border-left-color: #da291c; }
        .box-t { font-size: 7px; color: #a1b1c1; margin: 0; text-transform: uppercase; }
        .box-v { font-size: 16px; font-weight: bold; color: #f9b218; margin: 0; line-height: 1; }

        .list-p { width: 200px; height: 40px; overflow-y: auto; background: rgba(0,0,0,0.1); padding: 2px; border-radius: 3px; }
        .item-p { font-size: 9px; background: rgba(218,41,28,0.3); margin-bottom: 2px; padding: 2px 5px; display: flex; justify-content: space-between; border: 0.5px solid #da291c; }

        .gauges { display: flex; justify-content: center; gap: 10px; padding: 20px; flex-wrap: nowrap; }
        .card { background: white; color: black; width: 110px; padding: 10px; border-radius: 5px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        .btn-x { background: #da291c; color: white; border: none; padding: 5px 10px; cursor: pointer; font-weight: bold; border-radius: 3px; }
    </style>
</head>
<body>

<div class="top-bar">
    <img src="https://manttoprogramadosatex-a11y.github.io/mantenimiento-dashboard/logo.png.jpeg" class="logo">
    <div class="title">TABLERO MASTER SATEX</div>
    <div class="stats">
        <div class="box"><p class="box-t">Continuas</p><p class="box-v" id="c1">0</p></div>
        <div class="box"><p class="box-t">Open-End</p><p class="box-v" id="c2">0</p></div>
        <div class="box"><p class="box-t">Coneras</p><p class="box-v" id="c3">0</p></div>
        <div class="box box-r"><p class="box-t">Paradas</p><p class="box-v" id="tp" style="color:#ff9999">0</p></div>
    </div>
    <div class="list-p" id="lista"></div>
    <div style="font-size: 9px; text-align: right;">Act:<br><span id="sync" style="color:#00d4ff">...</span></div>
    <button class="btn-x" onclick="location.reload()">X</button>
</div>

<div class="gauges" id="g-cont"></div>

<script>
    // PEGA TU URL AQUÃ ABAJO
    const URL = "TU_URL_AQUI"; 
    
    let charts = [];
    async function load() {
        try {
            const r = await fetch(URL);
            const d = await r.json();
            document.getElementById('c1').innerText = d.husos.cont;
            document.getElementById('c2').innerText = d.husos.oe;
            document.getElementById('c3').innerText = d.husos.con;
            document.getElementById('tp').innerText = d.paradas.length;
            document.getElementById('sync').innerText = d.actualizado;
            
            document.getElementById('lista').innerHTML = d.paradas.map(p => `<div class="item-p"><span>${p.m}</span><b>${p.d}D</b></div>`).join('');
            
            d.cardas.forEach((c, i) => {
                const p = Math.min((c.a / c.m) * 100, 100);
                charts[i].data.datasets[0].data = [p, 100 - p];
                document.getElementById(`v-${i}`).innerText = `Ac. ${c.a}`;
                charts[i].update();
            });
        } catch(e) { document.getElementById('sync').innerText = "Error Red"; }
    }

    function init() {
        const container = document.getElementById('g-cont');
        for(let i=0; i<8; i++) {
            container.innerHTML += `<div class="card"><b>CARDA ${i+1}</b><canvas id="ch${i}"></canvas><b id="v-${i}" style="font-size:11px">--</b></div>`;
        }
        for(let i=0; i<8; i++) {
            charts.push(new Chart(document.getElementById(`ch${i}`), {
                type: 'doughnut',
                data: { datasets: [{ data: [0, 100], backgroundColor: ['#23a446', '#eee'] }] },
                options: { rotation: -110, circumference: 220, cutout: '75%', plugins: { legend: false } }
            }));
        }
        load();
        setInterval(load, 60000);
    }
    window.onload = init;
</script>
</body>
</html>
